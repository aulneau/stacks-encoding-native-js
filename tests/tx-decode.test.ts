import { decodeTransaction, TxPayloadContractCall } from '../index.js';

test('decode tx - contract-call 1', () => {
  const decoded = decodeTransaction('0x00000000010400b1907a5f15e25dfbb7487a032d37f61205d6127600000000000001ba0000000000002710000004fbc868d0ca4a9145f43a396c796bcbb2888a5519afe08ab80afc3e1d4f86607e66f795e59efa824c12782870f8fa29aaf03eb0380fde6e70b8bbf2e2a5f8c8030200000002010216b1907a5f15e25dfbb7487a032d37f61205d6127616e685b016b3b6cd9ebf35f38e5ae29392e2acd51d176167653030302d676f7665726e616e63652d746f6b656e04616c65780100000012f2fd9506000316e685b016b3b6cd9ebf35f38e5ae29392e2acd51d0a616c65782d7661756c7403000000002c9ad3150216e685b016b3b6cd9ebf35f38e5ae29392e2acd51d1766697865642d7765696768742d706f6f6c2d76312d30310b737761702d68656c706572000000060616e685b016b3b6cd9ebf35f38e5ae29392e2acd51d176167653030302d676f7665726e616e63652d746f6b656e0616e685b016b3b6cd9ebf35f38e5ae29392e2acd51d0a746f6b656e2d777374780100000000000000000000000002faf0800100000000000000000000000002faf08001000000000000000000000012f2fd95060a010000000000000000000000116c7a7446');
  expect(decoded).toEqual(
    {
      "anchor_mode": 3,
      "auth": {
        "origin_condition": {
          "hash_mode": 0,
          "key_encoding": 0,
          "nonce": "442",
          "signature": "0x0004fbc868d0ca4a9145f43a396c796bcbb2888a5519afe08ab80afc3e1d4f86607e66f795e59efa824c12782870f8fa29aaf03eb0380fde6e70b8bbf2e2a5f8c8",
          "signer": {
            "address": "SP2RS0YJZ2QH5VYXQ91X06B9QYR90BNGJETWP0V69",
            "address_hash_bytes": "0xb1907a5f15e25dfbb7487a032d37f61205d61276",
            "address_version": 22
          },
          "tx_fee": "10000"
        },
        "type_id": 4
      },
      "chain_id": 1,
      "payload": {
        "address": "SP3K8BC0PPEVCV7NZ6QSRWPQ2JE9E5B6N3PA0KBR9",
        "address_hash_bytes": "0xe685b016b3b6cd9ebf35f38e5ae29392e2acd51d",
        "address_version": 22,
        "contract_name": "fixed-weight-pool-v1-01",
        "function_args": [
          {
            "hex": "0x0616e685b016b3b6cd9ebf35f38e5ae29392e2acd51d176167653030302d676f7665726e616e63652d746f6b656e",
            "repr": "'SP3K8BC0PPEVCV7NZ6QSRWPQ2JE9E5B6N3PA0KBR9.age000-governance-token",
            "type_id": 6
          },
          {
            "hex": "0x0616e685b016b3b6cd9ebf35f38e5ae29392e2acd51d0a746f6b656e2d77737478",
            "repr": "'SP3K8BC0PPEVCV7NZ6QSRWPQ2JE9E5B6N3PA0KBR9.token-wstx",
            "type_id": 6
          },
          {
            "hex": "0x0100000000000000000000000002faf080",
            "repr": "u50000000",
            "type_id": 1
          },
          {
            "hex": "0x0100000000000000000000000002faf080",
            "repr": "u50000000",
            "type_id": 1
          },
          {
            "hex": "0x01000000000000000000000012f2fd9506",
            "repr": "u81386116358",
            "type_id": 1
          },
          {
            "hex": "0x0a010000000000000000000000116c7a7446",
            "repr": "(some u74834408518)",
            "type_id": 10
          }
        ],
        "function_args_buffer": "0x000000060616e685b016b3b6cd9ebf35f38e5ae29392e2acd51d176167653030302d676f7665726e616e63652d746f6b656e0616e685b016b3b6cd9ebf35f38e5ae29392e2acd51d0a746f6b656e2d777374780100000000000000000000000002faf0800100000000000000000000000002faf08001000000000000000000000012f2fd95060a010000000000000000000000116c7a7446",
        "function_name": "swap-helper",
        "type_id": 2
      },
      "post_condition_mode": 2,
      "post_conditions": [
        {
          "amount": "81386116358",
          "asset": {
            "asset_name": "alex",
            "contract_address": "SP3K8BC0PPEVCV7NZ6QSRWPQ2JE9E5B6N3PA0KBR9",
            "contract_name": "age000-governance-token"
          },
          "asset_info_id": 1,
          "condition_code": 1,
          "condition_name": "sent_equal_to",
          "principal": {
            "address": "SP2RS0YJZ2QH5VYXQ91X06B9QYR90BNGJETWP0V69",
            "address_hash_bytes": "0xb1907a5f15e25dfbb7487a032d37f61205d61276",
            "address_version": 22,
            "type_id": 2
          }
        },
        {
          "amount": "748344085",
          "asset_info_id": 0,
          "condition_code": 3,
          "condition_name": "sent_greater_than_or_equal_to",
          "principal": {
            "address": "SP3K8BC0PPEVCV7NZ6QSRWPQ2JE9E5B6N3PA0KBR9",
            "address_hash_bytes": "0xe685b016b3b6cd9ebf35f38e5ae29392e2acd51d",
            "address_version": 22,
            "contract_name": "alex-vault",
            "type_id": 3
          }
        }
      ],
      "post_conditions_buffer": "0x0200000002010216b1907a5f15e25dfbb7487a032d37f61205d6127616e685b016b3b6cd9ebf35f38e5ae29392e2acd51d176167653030302d676f7665726e616e63652d746f6b656e04616c65780100000012f2fd9506000316e685b016b3b6cd9ebf35f38e5ae29392e2acd51d0a616c65782d7661756c7403000000002c9ad315",
      "tx_id": "0xe68fdfbd58ae0af30de0c32ee640c64f3f77a425c6792e90e46d45c4c9178e19",
      "version": 0
    }
  );
});

test('decode tx - contract-call 2', () => {
  const decoded = decodeTransaction('0000000001040089f5fd1f719e4449c980de38e3504be6770a2698000000000000014500000000000001f400008b510c9e20dc22040953d9d7eabf2038008fa4d89a5a6cb78bb9d513e75cd0df3924af9ce3b5f185705bc2f6ba3071710ec6a8803ed6da4addc40a05a01ee0f503020000000102021689f5fd1f719e4449c980de38e3504be6770a269816a6a7a70f41adbe8eae708ed7ec2cbf41a272182014626974636f696e2d6d6f6e6b6579732d6c61627314626974636f696e2d6d6f6e6b6579732d6c61627301000000000000000000000000000008ba1002162bcf9762d5b90bc36dc1b4759b1727690f92ddd30e6d61726b6574706c6163652d76340a6c6973742d6173736574000000040616a6a7a70f41adbe8eae708ed7ec2cbf41a272182014626974636f696e2d6d6f6e6b6579732d6c61627301000000000000000000000000000008ba010000000000000000000000000c84588001000000000000000000000000000000c8');
  expect(decoded).toEqual(
    {
      "anchor_mode": 3,
      "auth": {
        "origin_condition": {
          "hash_mode": 0,
          "key_encoding": 0,
          "nonce": "325",
          "signature": "0x008b510c9e20dc22040953d9d7eabf2038008fa4d89a5a6cb78bb9d513e75cd0df3924af9ce3b5f185705bc2f6ba3071710ec6a8803ed6da4addc40a05a01ee0f5",
          "signer": {
            "address": "SP24ZBZ8ZE6F48JE9G3F3HRTG9FK7E2H6K2QZ3Q1K",
            "address_hash_bytes": "0x89f5fd1f719e4449c980de38e3504be6770a2698",
            "address_version": 22
          },
          "tx_fee": "500"
        },
        "type_id": 4
      },
      "chain_id": 1,
      "payload": {
        "address": "SPNWZ5V2TPWGQGVDR6T7B6RQ4XMGZ4PXTEE0VQ0S",
        "address_hash_bytes": "0x2bcf9762d5b90bc36dc1b4759b1727690f92ddd3",
        "address_version": 22,
        "contract_name": "marketplace-v4",
        "function_args": [
          {
            "hex": "0x0616a6a7a70f41adbe8eae708ed7ec2cbf41a272182014626974636f696e2d6d6f6e6b6579732d6c616273",
            "repr": "'SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C.bitcoin-monkeys-labs",
            "type_id": 6
          },
          {
            "hex": "0x01000000000000000000000000000008ba",
            "repr": "u2234",
            "type_id": 1
          },
          {
            "hex": "0x010000000000000000000000000c845880",
            "repr": "u210000000",
            "type_id": 1
          },
          {
            "hex": "0x01000000000000000000000000000000c8",
            "repr": "u200",
            "type_id": 1
          }
        ],
        "function_args_buffer": "0x000000040616a6a7a70f41adbe8eae708ed7ec2cbf41a272182014626974636f696e2d6d6f6e6b6579732d6c61627301000000000000000000000000000008ba010000000000000000000000000c84588001000000000000000000000000000000c8",
        "function_name": "list-asset",
        "type_id": 2
      },
      "post_condition_mode": 2,
      "post_conditions": [
        {
          "asset": {
            "asset_name": "bitcoin-monkeys-labs",
            "contract_address": "SP2KAF9RF86PVX3NEE27DFV1CQX0T4WGR41X3S45C",
            "contract_name": "bitcoin-monkeys-labs"
          },
          "asset_info_id": 2,
          "asset_value": {
            "hex": "0x01000000000000000000000000000008ba",
            "repr": "u2234",
            "type_id": 1
          },
          "condition_code": 16,
          "condition_name": "sent",
          "principal": {
            "address": "SP24ZBZ8ZE6F48JE9G3F3HRTG9FK7E2H6K2QZ3Q1K",
            "address_hash_bytes": "0x89f5fd1f719e4449c980de38e3504be6770a2698",
            "address_version": 22,
            "type_id": 2
          }
        }
      ],
      "post_conditions_buffer": "0x020000000102021689f5fd1f719e4449c980de38e3504be6770a269816a6a7a70f41adbe8eae708ed7ec2cbf41a272182014626974636f696e2d6d6f6e6b6579732d6c61627314626974636f696e2d6d6f6e6b6579732d6c61627301000000000000000000000000000008ba10",
      "tx_id": "0x49bcdba540d5c486f6f7a71de639a128a65f0378d7571e20c75a61661dd5b469",
      "version": 0
    }
  );
});

test('decode tx - token-transfer', () => {
  const decoded = decodeTransaction('00000000010400d27548439b50c8d8ca86756151bd6e07059510a0000000000000002f00000000000027100000ffdf728bc8d1423ba751e164a153b160c48980e727c98971816096534ee6b3a40e81b31786a547cc64fcb52d592939ec5a5886d8ec8053a91e22e76cb9ef4d4403020000000000051634ddc468605d7e5b65f2970002ae55b554f5dda400000000001e848000000000000000000000000000000000000000000000000000000000000000000000');
  expect(decoded).toEqual(
    {
      "anchor_mode": 3,
      "auth": {
        "origin_condition": {
          "hash_mode": 0,
          "key_encoding": 0,
          "nonce": "47",
          "signature": "0x00ffdf728bc8d1423ba751e164a153b160c48980e727c98971816096534ee6b3a40e81b31786a547cc64fcb52d592939ec5a5886d8ec8053a91e22e76cb9ef4d44",
          "signer": {
            "address": "SP397AJ23KD8CHP6AGSTP2MDXDR3GB58GM1NCJD22",
            "address_hash_bytes": "0xd27548439b50c8d8ca86756151bd6e07059510a0",
            "address_version": 22
          },
          "tx_fee": "10000"
        },
        "type_id": 4
      },
      "chain_id": 1,
      "payload": {
        "amount": "2000000",
        "memo_hex": "0x00000000000000000000000000000000000000000000000000000000000000000000",
        "recipient": {
          "address": "SPTDVH38C1EQWPV5YABG00NEAPTN9XEXMJHSEW92",
          "address_hash_bytes": "0x34ddc468605d7e5b65f2970002ae55b554f5dda4",
          "address_version": 22,
          "type_id": 5
        },
        "type_id": 0
      },
      "post_condition_mode": 2,
      "post_conditions": [],
      "post_conditions_buffer": "0x0200000000",
      "tx_id": "0xb81f2fdcc66926d846a4cfdad426a66a2a5a183208bffcbc1e0c1a453e662171",
      "version": 0
    }
  )
});

test('decode tx - smart-contract', () => {
  const decoded = decodeTransaction('000000000104008e78fd48543bb20a9f9b78558ab5a98388dc82a600000000000000ff00000000000b71b000009539c9b4514276db6376d2525251446719e884b0a996ac9018815fe9043fcc751798f7f02ea01c1d1673d163ab18bd048da828bc2f1716666b54ea93370d4031030100000000011566726f7a656e2d737461636b732d706f70732d763100000b4428646566696e652d6e6f6e2d66756e6769626c652d746f6b656e2066726f7a656e2d737461636b732d706f70732075696e74290a0a3b3b2053746f726167650a28646566696e652d6d617020746f6b656e2d636f756e74207072696e636970616c2075696e74290a0a3b3b20446566696e6520436f6e7374616e74730a28646566696e652d636f6e7374616e7420434f4e54524143542d4f574e45522074782d73656e646572290a28646566696e652d636f6e7374616e74204552522d4e4f542d415554484f52495a45442028657272207534303129290a28646566696e652d636f6e7374616e74204552522d4d455441444154412d46524f5a454e2028657272207535303529290a28646566696e652d636f6e7374616e74204552522d4d494e542d414c52454144592d5345542028657272207535303629290a0a3b3b20446566696e65205661726961626c65730a28646566696e652d646174612d766172206c6173742d69642075696e74207530290a28646566696e652d646174612d766172206d657461646174612d66726f7a656e20626f6f6c2066616c7365290a28646566696e652d646174612d76617220626173652d7572692028737472696e672d617363696920323536292022697066733a2f2f516d617948436f593235656e7234586d4251787956464b535539746b52507936344a79774e4444614b3963384d542f66726f7a656e2d737461636b732d706f70732d7b69647d2e6a736f6e22290a28646566696e652d636f6e7374616e7420636f6e74726163742d7572692022697066733a2f2f516d617948436f593235656e7234586d4251787956464b535539746b52507936344a79774e4444614b3963384d542f66726f7a656e2d737461636b732d706f70732e6a736f6e22290a28646566696e652d6d6170206d696e742d6164647265737320626f6f6c207072696e636970616c290a0a3b3b20546f6b656e20636f756e7420666f72206163636f756e740a28646566696e652d726561642d6f6e6c7920286765742d62616c616e636520286163636f756e74207072696e636970616c29290a20202864656661756c742d746f2075300a20202020286d61702d6765743f20746f6b656e2d636f756e74206163636f756e742929290a0a3b3b205349503030393a205472616e7366657220746f6b656e20746f206120737065636966696564207072696e636970616c0a28646566696e652d7075626c696320287472616e73666572202869642075696e7429202873656e646572207072696e636970616c292028726563697069656e74207072696e636970616c29290a20204552522d4e4f542d415554484f52495a4544290a0a3b3b205349503030393a2047657420746865206f776e6572206f66207468652073706563696669656420746f6b656e2049440a28646566696e652d726561642d6f6e6c7920286765742d6f776e6572202869642075696e7429290a20203b3b204d616b65207375726520746f207265706c6163652066726f7a656e2d737461636b732d706f70730a2020286f6b20286e66742d6765742d6f776e65723f2066726f7a656e2d737461636b732d706f70732069642929290a0a3b3b205349503030393a2047657420746865206c61737420746f6b656e2049440a28646566696e652d726561642d6f6e6c7920286765742d6c6173742d746f6b656e2d6964290a2020286f6b20287661722d676574206c6173742d69642929290a0a3b3b205349503030393a204765742074686520746f6b656e205552492e20596f752063616e2073657420697420746f20616e79206f74686572205552490a28646566696e652d726561642d6f6e6c7920286765742d746f6b656e2d757269202869642075696e7429290a2020286f6b2028736f6d6520287661722d67657420626173652d757269292929290a0a28646566696e652d726561642d6f6e6c7920286765742d636f6e74726163742d757269290a2020286f6b20636f6e74726163742d75726929290a0a3b3b204d696e74206e6577204e46540a3b3b2063616e206f6e6c792062652063616c6c65642066726f6d20746865204d696e740a28646566696e652d7075626c696320286d696e7420286e65772d6f776e6572207072696e636970616c29202869642075696e7429290a2020286c6574200a2020202028286f776e65722d62616c616e636520286765742d62616c616e6365206e65772d6f776e65722929290a20202020286173736572747321202863616c6c65642d66726f6d2d6d696e7429204552522d4e4f542d415554484f52495a4544290a20202020287472792120286e66742d6d696e743f2066726f7a656e2d737461636b732d706f7073206964206e65772d6f776e657229290a20202020286d61702d73657420746f6b656e2d636f756e740a2020202020206e65772d6f776e65720a202020202020282b206f776e65722d62616c616e636520753129290a20202020286f6b2074727565290a2020290a290a0a28646566696e652d7075626c696320286275726e202869642075696e742920286f776e6572207072696e636970616c29290a2020286c6574200a2020202028286f776e65722d62616c616e636520286765742d62616c616e6365206f776e65722929290a20202020286173736572747321202863616c6c65642d66726f6d2d6d696e7429204552522d4e4f542d415554484f52495a4544290a20202020287472792120286e66742d6275726e3f2066726f7a656e2d737461636b732d706f7073206964206f776e657229290a20202020286d61702d73657420746f6b656e2d636f756e740a2020202020206f776e65720a202020202020282d206f776e65722d62616c616e636520753129290a20202020286f6b2074727565290a2020290a290a0a3b3b205365742062617365207572690a28646566696e652d7075626c696320287365742d626173652d75726920286e65772d626173652d7572692028737472696e672d6173636969203235362929290a202028626567696e0a20202020286173736572747321202869732d657120636f6e74726163742d63616c6c657220434f4e54524143542d4f574e455229204552522d4e4f542d415554484f52495a4544290a2020202028617373657274732120286e6f7420287661722d676574206d657461646174612d66726f7a656e2929204552522d4d455441444154412d46524f5a454e290a20202020287661722d73657420626173652d757269206e65772d626173652d757269290a20202020286f6b20747275652929290a0a3b3b20467265657a65206d657461646174610a28646566696e652d7075626c69632028667265657a652d6d65746164617461290a202028626567696e0a20202020286173736572747321202869732d657120636f6e74726163742d63616c6c657220434f4e54524143542d4f574e455229204552522d4e4f542d415554484f52495a4544290a20202020287661722d736574206d657461646174612d66726f7a656e2074727565290a20202020286f6b20747275652929290a0a3b3b204d616e61676520746865204d696e740a28646566696e652d70726976617465202863616c6c65642d66726f6d2d6d696e74290a20202869732d657120636f6e74726163742d63616c6c65722028756e777261702120286d61702d6765743f206d696e742d616464726573732074727565292066616c73652929290a0a3b3b2063616e206f6e6c792062652063616c6c6564206f6e63650a28646566696e652d7075626c696320287365742d6d696e742d61646472657373290a202028626567696e0a2020202028617373657274732120286d61702d696e73657274206d696e742d6164647265737320747275652074782d73656e64657229204552522d4d494e542d414c52454144592d534554290a20202020286f6b20287072696e742074782d73656e64657229292929');
  expect(decoded).toEqual(
    {
      "tx_id": "0xd2e36176900e65b01684d651f8faa2794a835a05173a3f0596600bf53f6d4e58",
      "version": 0,
      "chain_id": 1,
      "auth": {
        "type_id": 4,
        "origin_condition": {
          "hash_mode": 0,
          "signer": {
            "address_version": 22,
            "address_hash_bytes": "0x8e78fd48543bb20a9f9b78558ab5a98388dc82a6",
            "address": "SP277HZA8AGXV42MZKDW5B2NNN61RHQ42MTAHVNB1"
          },
          "nonce": "255",
          "tx_fee": "750000",
          "key_encoding": 0,
          "signature": "0x009539c9b4514276db6376d2525251446719e884b0a996ac9018815fe9043fcc751798f7f02ea01c1d1673d163ab18bd048da828bc2f1716666b54ea93370d4031"
        }
      },
      "anchor_mode": 3,
      "post_condition_mode": 1,
      "post_conditions": [],
      "post_conditions_buffer": "0x0100000000",
      "payload": {
        "type_id": 1,
        "contract_name": "frozen-stacks-pops-v1",
        "code_body": "(define-non-fungible-token frozen-stacks-pops uint)\n\n;; Storage\n(define-map token-count principal uint)\n\n;; Define Constants\n(define-constant CONTRACT-OWNER tx-sender)\n(define-constant ERR-NOT-AUTHORIZED (err u401))\n(define-constant ERR-METADATA-FROZEN (err u505))\n(define-constant ERR-MINT-ALREADY-SET (err u506))\n\n;; Define Variables\n(define-data-var last-id uint u0)\n(define-data-var metadata-frozen bool false)\n(define-data-var base-uri (string-ascii 256) \"ipfs://QmayHCoY25enr4XmBQxyVFKSU9tkRPy64JywNDDaK9c8MT/frozen-stacks-pops-{id}.json\")\n(define-constant contract-uri \"ipfs://QmayHCoY25enr4XmBQxyVFKSU9tkRPy64JywNDDaK9c8MT/frozen-stacks-pops.json\")\n(define-map mint-address bool principal)\n\n;; Token count for account\n(define-read-only (get-balance (account principal))\n  (default-to u0\n    (map-get? token-count account)))\n\n;; SIP009: Transfer token to a specified principal\n(define-public (transfer (id uint) (sender principal) (recipient principal))\n  ERR-NOT-AUTHORIZED)\n\n;; SIP009: Get the owner of the specified token ID\n(define-read-only (get-owner (id uint))\n  ;; Make sure to replace frozen-stacks-pops\n  (ok (nft-get-owner? frozen-stacks-pops id)))\n\n;; SIP009: Get the last token ID\n(define-read-only (get-last-token-id)\n  (ok (var-get last-id)))\n\n;; SIP009: Get the token URI. You can set it to any other URI\n(define-read-only (get-token-uri (id uint))\n  (ok (some (var-get base-uri))))\n\n(define-read-only (get-contract-uri)\n  (ok contract-uri))\n\n;; Mint new NFT\n;; can only be called from the Mint\n(define-public (mint (new-owner principal) (id uint))\n  (let \n    ((owner-balance (get-balance new-owner)))\n    (asserts! (called-from-mint) ERR-NOT-AUTHORIZED)\n    (try! (nft-mint? frozen-stacks-pops id new-owner))\n    (map-set token-count\n      new-owner\n      (+ owner-balance u1))\n    (ok true)\n  )\n)\n\n(define-public (burn (id uint) (owner principal))\n  (let \n    ((owner-balance (get-balance owner)))\n    (asserts! (called-from-mint) ERR-NOT-AUTHORIZED)\n    (try! (nft-burn? frozen-stacks-pops id owner))\n    (map-set token-count\n      owner\n      (- owner-balance u1))\n    (ok true)\n  )\n)\n\n;; Set base uri\n(define-public (set-base-uri (new-base-uri (string-ascii 256)))\n  (begin\n    (asserts! (is-eq contract-caller CONTRACT-OWNER) ERR-NOT-AUTHORIZED)\n    (asserts! (not (var-get metadata-frozen)) ERR-METADATA-FROZEN)\n    (var-set base-uri new-base-uri)\n    (ok true)))\n\n;; Freeze metadata\n(define-public (freeze-metadata)\n  (begin\n    (asserts! (is-eq contract-caller CONTRACT-OWNER) ERR-NOT-AUTHORIZED)\n    (var-set metadata-frozen true)\n    (ok true)))\n\n;; Manage the Mint\n(define-private (called-from-mint)\n  (is-eq contract-caller (unwrap! (map-get? mint-address true) false)))\n\n;; can only be called once\n(define-public (set-mint-address)\n  (begin\n    (asserts! (map-insert mint-address true tx-sender) ERR-MINT-ALREADY-SET)\n    (ok (print tx-sender))))"
      }
    }
  );
});

test('decode tx - coinbase', () => {
  const decoded = decodeTransaction('00000000010400b00de0cc7b5e518f7d1e43d6e5ecbd52e0cd0c2f0000000000001ddc00000000000000000001827095db6a9de80e51323bc96a926874999472634fbdfd5adc36df48e2d6b01c7505244fba66e8812b761a2ea1f1e98253139db1ccd1c7ffaa14208dd489bf69010200000000040000000000000000000000000000000000000000000000000000000000000000');
  expect(decoded).toEqual(
    {
      "anchor_mode": 1,
      "auth": {
        "origin_condition": {
          "hash_mode": 0,
          "key_encoding": 0,
          "nonce": "7644",
          "signature": "0x01827095db6a9de80e51323bc96a926874999472634fbdfd5adc36df48e2d6b01c7505244fba66e8812b761a2ea1f1e98253139db1ccd1c7ffaa14208dd489bf69",
          "signer": {
            "address": "SP2R0VR6CFDF533VX3S1XDSFCQN9E1K8C5WS5Q9JC",
            "address_hash_bytes": "0xb00de0cc7b5e518f7d1e43d6e5ecbd52e0cd0c2f",
            "address_version": 22
          },
          "tx_fee": "0"
        },
        "type_id": 4
      },
      "chain_id": 1,
      "payload": {
        "payload_buffer": "0x0000000000000000000000000000000000000000000000000000000000000000",
        "type_id": 4
      },
      "post_condition_mode": 2,
      "post_conditions": [],
      "post_conditions_buffer": "0x0200000000",
      "tx_id": "0xd59d655128d67e33c6e9c20c7cca309b91da352358639092e13ce74fc0a6a5d4",
      "version": 0
    }
  );
});

test('decode tx - sponsored', () => {
  const decoded = decodeTransaction('000000000105001f6000287c9ed40ba39b27fc4257ff30cda4e91d000000000000005c0000000000000000000188f35fb5444ebdfcfced4b267aa76e60b90fc38ff7f7c8d770fc21407a26650a78aded3af77a5f0d7ca2ba7dabeff0579ec1d891e715c55237cfd5737e42378000661506d48705f932af21abcff23046b216886e840000000000000a1a000000000007a12000003fe006c2b46c5c6a16bc0af6f065c63d6e6c5a40e51fec26a9768caab0acd7ca42401d9c8030f120d2005388c1d04c602a3a9177eb26534a4fd6a3897686b1490302000000010002161f6000287c9ed40ba39b27fc4257ff30cda4e91d0100000000bda999040216debc095099629badb11b9d5335e874d12f1f1d450e73656e642d6d616e792d6d656d6f0973656e642d6d616e79000000010b0000001e0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05162c34acd88561d6905f635e8eb59a36395b8c42a1047573747801000000000000000000000000002e640b0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516f1818ba832287fc71375c3e78bae2c8c64f6bb01047573747801000000000000000000000000008d51b10c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516267248c930110d411248d9ff16e63a8ddfa0c641047573747801000000000000000000000000121d39d80c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516e73e15214dab160f2b78c935279e99a4a8ce83fc047573747801000000000000000000000000003beba90c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05166176366f88666f63ee0280db409fc8bcdc5eccbd047573747801000000000000000000000000056fb9430c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516cb8de306c17412fc869c8337fa7b6b6f3a17cc160475737478010000000000000000000000000014018b0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516477b4de6bfcf52f8cfec6854720b7a6982193eb704757374780100000000000000000000000005f518e20c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051668210b7f12b4ee43f374da9a59a51ecc8d0d89230475737478010000000000000000000000000029a8780c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05163b8e6ef49d23e432100aeca022c89555b7209aad04757374780100000000000000000000000010152ebb0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051694401aeb5474061ac390f723cb1826feb1b90448047573747801000000000000000000000000482a34380c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051686e0feea7bd59ae51dd0d2e47c7220406348e73804757374780100000000000000000000000000c938550c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516a52961a0d54cb3b9ce9a7092440dff4573cff58c04757374780100000000000000000000000000f19d340c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516130b7aee04f3eee627e103d3c33aea1d5339087d047573747801000000000000000000000000032aadd60c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05165db3d733033684784ebfa931b8e5f228bb247c4d04757374780100000000000000000000000000adf7280c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051600da0575e398c7b3d64f3df9d32ec57b9c0af3f704757374780100000000000000000000000000adf7280c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051607b7982ea3aaff67270d86e62436b0d08ea8d17804757374780100000000000000000000000010bc307b0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516fd048b0a4e906580e4a5281ebef59f2d60585ac4047573747801000000000000000000000000076efb580c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05164ecd67a6d4ca15c0cb9cf7cc0bc0594ba10ce4ee047573747801000000000000000000000000016a6c4c0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516f6641fafd4cdb742214558a43a5effeeb6061d76047573747801000000000000000000000000002a5b460c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05166af9a2a4e295c9b23b7304f4bd14082b7101e7c304757374780100000000000000000000000002b299d90c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05166c317c39e65133aa7a414eb75e516dc59536f55004757374780100000000000000000000000018b0beba0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516e13a94997d076788fa000588d7bfb053b2cfa3c3047573747801000000000000000000000000003b2c660c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05165b7ee1d697120fbe6a761df99cddb46774cf1ca50475737478010000000000000000000000000005da110c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051688e4220b60f2222e115d8a8b1e46b09aed368854047573747801000000000000000000000000056d4c270c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051609973469a88ffcbf70651d8078442b9eedd47f590475737478010000000000000000000000000002e6410c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05162bbf6ea8291431ec60fcb86c066ff375071ce7d8047573747801000000000000000000000000001e57d60c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516fbd72ce502f8a46db5a6e473a4e2c8830bc1a43904757374780100000000000000000000000001a593880c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051667a3c0f1b06075e9f7b9fa4d3e5d6492041c295a0475737478010000000000000000000000000005cb390c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516cba8da4a454ae7ad02cb71fb523ddd720d73ad3a0475737478010000000000000000000000000176f41c0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05169bb88a9c3db00f126f08f380d28b348458ebb6f7047573747801000000000000000000000000025c3d73');
  expect(decoded).toEqual(
    {
      "tx_id": "0x3b1236287da14f8ffaa0e99ced3ce354986107ae08569fe7f1a497adfd37e2c7",
      "version": 0,
      "chain_id": 1,
      "auth": {
        "type_id": 5,
        "origin_condition": {
          "hash_mode": 0,
          "signer": {
            "address_version": 22,
            "address_hash_bytes": "0x1f6000287c9ed40ba39b27fc4257ff30cda4e91d",
            "address": "SPFP0018FJFD82X3KCKZRGJQZWRCV9793QTGE87M"
          },
          "nonce": "92",
          "tx_fee": "0",
          "key_encoding": 0,
          "signature": "0x0188f35fb5444ebdfcfced4b267aa76e60b90fc38ff7f7c8d770fc21407a26650a78aded3af77a5f0d7ca2ba7dabeff0579ec1d891e715c55237cfd5737e423780"
        },
        "sponsor_condition": {
          "hash_mode": 0,
          "signer": {
            "address_version": 22,
            "address_hash_bytes": "0x661506d48705f932af21abcff23046b216886e84",
            "address": "SP1K1A1PMGW2ZJCNF46NWZWHG8TS1D23EGH1KNK60"
          },
          "nonce": "2586",
          "tx_fee": "500000",
          "key_encoding": 0,
          "signature": "0x003fe006c2b46c5c6a16bc0af6f065c63d6e6c5a40e51fec26a9768caab0acd7ca42401d9c8030f120d2005388c1d04c602a3a9177eb26534a4fd6a3897686b149"
        }
      },
      "anchor_mode": 3,
      "post_condition_mode": 2,
      "post_conditions": [
        {
          "asset_info_id": 0,
          "principal": {
            "type_id": 2,
            "address_version": 22,
            "address_hash_bytes": "0x1f6000287c9ed40ba39b27fc4257ff30cda4e91d",
            "address": "SPFP0018FJFD82X3KCKZRGJQZWRCV9793QTGE87M"
          },
          "condition_code": 1,
          "condition_name": "sent_equal_to",
          "amount": "3182008580"
        }
      ],
      "post_conditions_buffer": "0x02000000010002161f6000287c9ed40ba39b27fc4257ff30cda4e91d0100000000bda99904",
      "payload": {
        "type_id": 2,
        "address_version": 22,
        "address_hash_bytes": "0xdebc095099629badb11b9d5335e874d12f1f1d45",
        "address": "SP3FBR2AGK5H9QBDH3EEN6DF8EK8JY7RX8QJ5SVTE",
        "contract_name": "send-many-memo",
        "function_name": "send-many",
        "function_args": [
          {
            "repr": "(list (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SPP39B6RGNGXD42ZCDF8XDCT6RWNQ322M58NBKSG) (ustx u3040267)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP3RR32X868M7ZHRKEQ1YF2XE5J669XNV06F38PQ9) (ustx u9261489)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SPK74J69608GTG8J93CZY5Q67A6XZ86687GCZSWE) (ustx u303905240)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP3KKW5919PNHC3SBF34KA9WYK6JAHKM3ZJ2NMCZ4) (ustx u3926953)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP1GQCDKFH1K6YRZE0A0DPG4ZS2YDRQPCQNHXPFJ0) (ustx u91208003)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP35RVRR6R5T15Z46KJ1KFYKVDDQKM5YC2T3A8NEP) (ustx u1311115)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP13QPKF6QZ7N5Y6FXHM58WGBF9MR469YPXQKE5PD) (ustx u99948770)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP1M222VZ2ATEWGZKEKD9MPD53V68T3C94DAPYMAW) (ustx u2730104)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SPXRWVQMKMHY8CGG1BPA08P8JNAVE84TNPQ0R0HA) (ustx u269823675)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP2A406QBAHT0C6P3J3VJ7JRR4VZB3E8491TWK08Y) (ustx u1210725432)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP23E1ZQAFFASNS8XT39E8Z3J41066J7772FWMQ9M) (ustx u13187157)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP2JJJRD0TN6B7EEEK9R94H0DZX2Q7KZNHGRVB6QA) (ustx u15834420)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP9GPYQE0KSYXSH7W41X7GSTX8EN6E88FPQ00BHY) (ustx u53128662)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP1EV7NSK0CV88Y2EQYMK3E75Y8MBP93W9M8WE9XV) (ustx u11401000)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP0DM1BNWECCFCYP9WYZKMSERNXSR2QKYY10NPSQ) (ustx u11401000)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP3VF61EMENFYSS71P3EC91PP388XA6HF2YTMXXA) (ustx u280768635)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP3YG92RA9T86B074MMM1XFQNKWPP0P2TRGMRNJ2D) (ustx u124713816)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP17CTSX6TK51BG6BKKVWR2Y0B55T2374XS22R1DC) (ustx u23751756)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP3V687XFTK6VEGH18NCA8EJYZZQBC1GXERFSE6Q0) (ustx u2775878)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP1NFK8N4WAAWKCHVEC2F9F8M10NQ20F7RD58DVZ9) (ustx u45259225)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP1P32Z1SWS8K7AKT857BEQJHDQ2SADQNA3KQZX93) (ustx u414236346)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP3GKN54SFM3PF27T002RHNXZP19V5KX3RFQCT86G) (ustx u3877990)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP1DQXREPJW90ZFKAEREZK76XPHKQ9KRWMQY81JAT) (ustx u383505)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP24E88GBC3S24BGHBP58P7J6P2DETDM8AH8R5GG4) (ustx u91048999)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP4SED39N27ZSFVGCMER0Y245EFEVN3ZB7SSMQGR) (ustx u190017)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SPNVYVN854A33V30ZJW6R1KFYDTGE777V0DGM5MG) (ustx u1988566)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP3XXEB750BWA8VDNMVJ77972S21GQGD477HKV1HG) (ustx u27628424)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP1KT7G7HP1G7BTFQQ7X4TFJXCJ908719BA2VBWHV) (ustx u379705)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP35THPJA8N5EFB82SDRZPMHXVNS0TWXD7AMQ5ZRK) (ustx u24572956)) (tuple (memo 0x726577617264206379636c6520233236207061796f7574) (to 'SP2DVH2MW7PR0Y4KF13SR1MMB6J25HTXPYZ5E8EAT) (ustx u39599475)))",
            "hex": "0x0b0000001e0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05162c34acd88561d6905f635e8eb59a36395b8c42a1047573747801000000000000000000000000002e640b0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516f1818ba832287fc71375c3e78bae2c8c64f6bb01047573747801000000000000000000000000008d51b10c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516267248c930110d411248d9ff16e63a8ddfa0c641047573747801000000000000000000000000121d39d80c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516e73e15214dab160f2b78c935279e99a4a8ce83fc047573747801000000000000000000000000003beba90c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05166176366f88666f63ee0280db409fc8bcdc5eccbd047573747801000000000000000000000000056fb9430c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516cb8de306c17412fc869c8337fa7b6b6f3a17cc160475737478010000000000000000000000000014018b0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516477b4de6bfcf52f8cfec6854720b7a6982193eb704757374780100000000000000000000000005f518e20c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051668210b7f12b4ee43f374da9a59a51ecc8d0d89230475737478010000000000000000000000000029a8780c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05163b8e6ef49d23e432100aeca022c89555b7209aad04757374780100000000000000000000000010152ebb0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051694401aeb5474061ac390f723cb1826feb1b90448047573747801000000000000000000000000482a34380c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051686e0feea7bd59ae51dd0d2e47c7220406348e73804757374780100000000000000000000000000c938550c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516a52961a0d54cb3b9ce9a7092440dff4573cff58c04757374780100000000000000000000000000f19d340c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516130b7aee04f3eee627e103d3c33aea1d5339087d047573747801000000000000000000000000032aadd60c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05165db3d733033684784ebfa931b8e5f228bb247c4d04757374780100000000000000000000000000adf7280c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051600da0575e398c7b3d64f3df9d32ec57b9c0af3f704757374780100000000000000000000000000adf7280c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051607b7982ea3aaff67270d86e62436b0d08ea8d17804757374780100000000000000000000000010bc307b0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516fd048b0a4e906580e4a5281ebef59f2d60585ac4047573747801000000000000000000000000076efb580c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05164ecd67a6d4ca15c0cb9cf7cc0bc0594ba10ce4ee047573747801000000000000000000000000016a6c4c0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516f6641fafd4cdb742214558a43a5effeeb6061d76047573747801000000000000000000000000002a5b460c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05166af9a2a4e295c9b23b7304f4bd14082b7101e7c304757374780100000000000000000000000002b299d90c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05166c317c39e65133aa7a414eb75e516dc59536f55004757374780100000000000000000000000018b0beba0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516e13a94997d076788fa000588d7bfb053b2cfa3c3047573747801000000000000000000000000003b2c660c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05165b7ee1d697120fbe6a761df99cddb46774cf1ca50475737478010000000000000000000000000005da110c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051688e4220b60f2222e115d8a8b1e46b09aed368854047573747801000000000000000000000000056d4c270c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051609973469a88ffcbf70651d8078442b9eedd47f590475737478010000000000000000000000000002e6410c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05162bbf6ea8291431ec60fcb86c066ff375071ce7d8047573747801000000000000000000000000001e57d60c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516fbd72ce502f8a46db5a6e473a4e2c8830bc1a43904757374780100000000000000000000000001a593880c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051667a3c0f1b06075e9f7b9fa4d3e5d6492041c295a0475737478010000000000000000000000000005cb390c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516cba8da4a454ae7ad02cb71fb523ddd720d73ad3a0475737478010000000000000000000000000176f41c0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05169bb88a9c3db00f126f08f380d28b348458ebb6f7047573747801000000000000000000000000025c3d73",
            "type_id": 11
          }
        ],
        "function_args_buffer": "0x000000010b0000001e0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05162c34acd88561d6905f635e8eb59a36395b8c42a1047573747801000000000000000000000000002e640b0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516f1818ba832287fc71375c3e78bae2c8c64f6bb01047573747801000000000000000000000000008d51b10c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516267248c930110d411248d9ff16e63a8ddfa0c641047573747801000000000000000000000000121d39d80c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516e73e15214dab160f2b78c935279e99a4a8ce83fc047573747801000000000000000000000000003beba90c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05166176366f88666f63ee0280db409fc8bcdc5eccbd047573747801000000000000000000000000056fb9430c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516cb8de306c17412fc869c8337fa7b6b6f3a17cc160475737478010000000000000000000000000014018b0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516477b4de6bfcf52f8cfec6854720b7a6982193eb704757374780100000000000000000000000005f518e20c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051668210b7f12b4ee43f374da9a59a51ecc8d0d89230475737478010000000000000000000000000029a8780c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05163b8e6ef49d23e432100aeca022c89555b7209aad04757374780100000000000000000000000010152ebb0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051694401aeb5474061ac390f723cb1826feb1b90448047573747801000000000000000000000000482a34380c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051686e0feea7bd59ae51dd0d2e47c7220406348e73804757374780100000000000000000000000000c938550c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516a52961a0d54cb3b9ce9a7092440dff4573cff58c04757374780100000000000000000000000000f19d340c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516130b7aee04f3eee627e103d3c33aea1d5339087d047573747801000000000000000000000000032aadd60c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05165db3d733033684784ebfa931b8e5f228bb247c4d04757374780100000000000000000000000000adf7280c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051600da0575e398c7b3d64f3df9d32ec57b9c0af3f704757374780100000000000000000000000000adf7280c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051607b7982ea3aaff67270d86e62436b0d08ea8d17804757374780100000000000000000000000010bc307b0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516fd048b0a4e906580e4a5281ebef59f2d60585ac4047573747801000000000000000000000000076efb580c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05164ecd67a6d4ca15c0cb9cf7cc0bc0594ba10ce4ee047573747801000000000000000000000000016a6c4c0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516f6641fafd4cdb742214558a43a5effeeb6061d76047573747801000000000000000000000000002a5b460c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05166af9a2a4e295c9b23b7304f4bd14082b7101e7c304757374780100000000000000000000000002b299d90c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05166c317c39e65133aa7a414eb75e516dc59536f55004757374780100000000000000000000000018b0beba0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516e13a94997d076788fa000588d7bfb053b2cfa3c3047573747801000000000000000000000000003b2c660c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05165b7ee1d697120fbe6a761df99cddb46774cf1ca50475737478010000000000000000000000000005da110c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051688e4220b60f2222e115d8a8b1e46b09aed368854047573747801000000000000000000000000056d4c270c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051609973469a88ffcbf70651d8078442b9eedd47f590475737478010000000000000000000000000002e6410c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05162bbf6ea8291431ec60fcb86c066ff375071ce7d8047573747801000000000000000000000000001e57d60c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516fbd72ce502f8a46db5a6e473a4e2c8830bc1a43904757374780100000000000000000000000001a593880c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f051667a3c0f1b06075e9f7b9fa4d3e5d6492041c295a0475737478010000000000000000000000000005cb390c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f0516cba8da4a454ae7ad02cb71fb523ddd720d73ad3a0475737478010000000000000000000000000176f41c0c00000003046d656d6f0200000017726577617264206379636c6520233236207061796f757402746f05169bb88a9c3db00f126f08f380d28b348458ebb6f7047573747801000000000000000000000000025c3d73"
      }
    }
  );
});

test('decode tx - contract call with large contract name arg', () => {
  const decoded = decodeTransaction('0x00000000010400982f3ec112a5f5928a5c96a914bd733793b896a5000000000000053000000000000002290000c85889dad0d5b08a997a93a28a7c93eb22c324e5f8992dc93e37865ef4f3e0d65383beefeffc4871a2facbc4b590ddf887c80de6638ed4e2ec0e633d1e130f230301000000000216982f3ec112a5f5928a5c96a914bd733793b896a51861726b6164696b6f2d676f7665726e616e63652d76332d310770726f706f7365000000060616982f3ec112a5f5928a5c96a914bd733793b896a51d61726b6164696b6f2d7374616b652d706f6f6c2d64696b6f2d76312d32010000000000000000000000000000ef8801000000000000000000000000000003f00e00000028414950313020557064617465204c54567320616e64204c69717569646174696f6e20526174696f730e0000003168747470733a2f2f6769746875622e636f6d2f61726b6164696b6f2d64616f2f61726b6164696b6f2f70756c6c2f3439330b000000010c0000000507616464726573730516982f3ec112a5f5928a5c96a914bd733793b896a50863616e2d6275726e040863616e2d6d696e7404046e616d650d0000002b61697031302d61726b6164696b6f2d7570646174652d74766c2d6c69717569646174696f6e2d726174696f0e7175616c69666965642d6e616d650616982f3ec112a5f5928a5c96a914bd733793b896a52b61697031302d61726b6164696b6f2d7570646174652d74766c2d6c69717569646174696f6e2d726174696f');
  const payload = decoded.payload as TxPayloadContractCall;
  const lastArgRepr = payload.function_args[5].repr;
  expect(lastArgRepr).toBe(`(list (tuple (address 'SP2C2YFP12AJZB4MABJBAJ55XECVS7E4PMMZ89YZR) (can-burn false) (can-mint false) (name "aip10-arkadiko-update-tvl-liquidation-ratio") (qualified-name 'SP2C2YFP12AJZB4MABJBAJ55XECVS7E4PMMZ89YZR.aip10-arkadiko-update-tvl-liquidation-ratio)))`)
});
